FROM python:2.7

RUN pip install cython

RUN mkdir -p /usr/src/app/requirements
WORKDIR /usr/src/app

ADD . /usr/src/app
RUN ["python", "setup.py", "develop"]

RUN pip uninstall dojotmodulepython
RUN pip install --extra-index-url http://172.22.0.1:8080/ dojotmodulepython --trusted-host 172.22.0.1

CMD ["python", "history/subscriber/persister.py"]
